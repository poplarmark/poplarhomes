<script>
console.log("93");const wf_form_main=document.getElementById("serviced-block_trigger-layer"),wf_form_unserviced=document.getElementById("unserviced-block_trigger-layer"),wf_form_empty=document.getElementById("emptyfield-block_trigger-layer"),form_rent_estimate=document.getElementById("form_rentestimate"),form_serviced=document.getElementById("form_serviced"),form_unserviced=document.getElementById("form_unserviced"),autocomplete_input=document.getElementById("pac_input"),property_type=document.getElementById("property-type"),bedroom_count=document.getElementById("rent-estimate_input-bedroom"),bathroom_count=document.getElementById("rent-estimate_input-bathroom"),serviced_input_firstname=document.getElementById("serviced_input-firstname"),serviced_input_lastname=document.getElementById("serviced_input-lastname"),serviced_input_email=document.getElementById("serviced_input-email"),serviced_input_phone=document.getElementById("serviced_input-phone"),unserviced_input_fullname=document.getElementById("unserviced_input-fullname"),unserviced_input_email=document.getElementById("unserviced_input-email"),unserviced_map=document.getElementById("unserviced_map"),autocomplete_options={componentRestrictions:{country:"us"}},pipeToGoogleSheet=function(e,t){$.ajax({url:e,method:"GET",dataType:"json",data:t,success:function(e){console.log("Google Sheet --\x3e",e)}})};function getGoogleAddressComponent(e,t,o){if(console.log(hasOwnProperty),e.length)for(var n=0;n<e.length;n++)if(e[n].hasOwnProperty("types"))for(var a=0;a<e[n].types.length;a++)if(e[n].types[a]===t)return e[n][o]}if(autocomplete_input){var autocomplete_component,autocomplete=new google.maps.places.Autocomplete(autocomplete_input,autocomplete_options);google.maps.event.addListener(autocomplete,"place_changed",(function(){let e=autocomplete.getPlace().address_components,t=document.getElementById("rent-estimate_input-postal-code");const o=getGoogleAddressComponent(e,"postal_code","short_name");t.value=o,"undefined"==t.value&&(t.value=""),autocomplete_component={city:getGoogleAddressComponent(e,"locality","long_name"),route:getGoogleAddressComponent(e,"route","short_name"),state:getGoogleAddressComponent(e,"administrative_area_level_1","short_name"),street_no:getGoogleAddressComponent(e,"street_number","long_name"),zip:t.value},t.addEventListener("change",(function(){autocomplete_component.zip=this.value,console.log("Updated zip_value:",this.value)})),console.log("ADDRESS:",autocomplete_component)}))}function addProperty(e,t,o){fetch("https://www.poplarhomes.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`${o}`},body:JSON.stringify({query:`mutation {\n                    addProperty(input: {\n                        property: {\n                            type: ${e.type},\n                            propertyCategory: ${e.propertyCategory},\n                            numBeds: ${e.numBeds},\n                            numBaths: ${e.numBaths},\n                            street: "${e.street}",\n                            city: "${e.city}",\n                            state: "${e.state}",\n                            zipCode: "${e.zipCode}",\n                            country: "USA"\n                        },\n                        UTMCampaign: "${t.UTMCampaign}",\n                        UTMContent: "${t.UTMContent}",\n                        UTMMedium: "${t.UTMMedium}",\n                        UTMSource: "${t.UTMSource}",\n                        UTMTerm: "${t.UTMTerm}",\n                    }) {\n                        property {\n                            propertyID\n                            unitNumber\n                            name\n                            numBaths\n                            numBeds\n                            status\n                            type\n                            communityFeatures\n                            interiorFeatures\n                            exteriorFeatures\n                            appliances\n                            isFurnished\n                            petPolicy\n                            petInformation\n                            climateControls\n                            washerDryerType\n                            additionalRooms\n                            desiredLeaseRange\n                            storageType\n                            storageFee\n                            parkingTypes\n                            renterResponsibleUtilities\n                            ownerResponsibleUtilities\n                            latitude\n                            longitude\n                            totalArea\n                            street\n                            city\n                            state\n                            country\n                            county\n                            zipCode\n                        }\n                    }\n                }`})}).then((e=>e.json())).then((e=>{})).catch((e=>{console.log(e)}))}function registerOwner(e,t,o){fetch("https://www.poplarhomes.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:`mutation {\n                    registerOwner(input: {\n                        user: {\n                            firstName: "${e.firstName}",\n                            lastName: "${e.lastName}",\n                            email: "${e.email}",\n                            phone: "${e.phone}",\n                            UTMCampaign: "${o.UTMCampaign}",\n                            UTMContent: "${o.UTMContent}",\n                            UTMMedium: "${o.UTMMedium}",\n                            UTMSource: "${o.UTMSource}",\n                            UTMTerm: "${o.UTMTerm}",\n                            leadSource: ONERENT_WEBSITE_GET_RENT_ESTIMATE_LANDING_PAGE\n                        }\n                    }) {\n                    token\n                    }\n                }`})}).then((e=>e.json())).then((n=>{if(n.errors){let t=new Date,n={Timestamp:t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+(t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()),Name:`${e.firstName} ${e.lastName}`,Email:`${e.email}`,phone:`${e.phone}`,Location:autocomplete_input.value,"Submission Error":"true",utm_source:`WEB-${o.UTMSource}`,utm_campaign:`${o.UTMCampaign}`,utm_medium:`${o.UTMMedium}`,utm_content:`${o.UTMContent}`};return pipeToGoogleSheet("https://script.google.com/macros/s/AKfycbwdTw0XzSPs4Y1Fou6jdLToblFjZneJZGRd2EEowbOMpTgX5te8/exec",n),!1}let a=n.data.registerOwner.token;addProperty(t,o,a)})).catch((e=>{console.log(e)}))}function autocompleteBindLocation(){window.addEventListener("load",(function(){var e=document.getElementsByClassName("pac-container")[0];jQuery(e).detach().appendTo("#input_wrap-location"),console.log("pac_container loaded")})),window.addEventListener("load",(function(){$(document).ready((function(){$("#onload-estimate-js").each((function(){$(this).insertAfter($(this).parent().find(".pac-container")),console.log("pac_mover loader")}))}))}));document.getElementById("pac_input").onpaste=e=>e.preventDefault()}document.addEventListener("DOMContentLoaded",(function(){autocompleteBindLocation(),phoneFormat(),form_rent_estimate.addEventListener("submit",(e=>{e.preventDefault();const t=getPoplarLocations();console.log("Cities:",t);const o=t.find((e=>e===autocomplete_component.city));if(autocomplete_component?.state&&("TX"===autocomplete_component.state||"SC"===autocomplete_component.state||"MO"===autocomplete_component.state||"IL"===autocomplete_component.state||"NC"===autocomplete_component.state||"OH"===autocomplete_component.state)&&autocomplete_component?.city&&o){wf_form_main.style.display="block;";document.querySelector("#serviced-block_trigger-layer .modal_component > .modal_heading").innerHTML="One of our local partners serves your area!"}autocomplete_component?.state&&("OR"===autocomplete_component.state||"TN"===autocomplete_component.state||"CA"===autocomplete_component.state||"WA"===autocomplete_component.state||"CO"===autocomplete_component.state||"NV"===autocomplete_component.state||"MD"===autocomplete_component.state)||autocomplete_component?.city&&("Las Vegas"===autocomplete_component.city||o)?wf_form_main.style.display="block":($(".address-map").attr("src","https://www.google.com/maps?q="+autocomplete_input.value+"&output=embed"),wf_form_unserviced.style.display="block")})),form_serviced.addEventListener("submit",(e=>{e.preventDefault();let t={type:property_type.value,propertyCategory:$("#property-type option:selected").attr("category_value"),numBeds:bedroom_count.value,numBaths:bathroom_count.value,street:autocomplete_component?autocomplete_component.street_no+" "+autocomplete_component.route:autocomplete_input.value,city:autocomplete_component&&autocomplete_component.city?autocomplete_component.city:"",state:autocomplete_component?autocomplete_component.state:"",zipCode:autocomplete_component?autocomplete_component.zip:""},o={firstName:serviced_input_firstname.value,lastName:serviced_input_lastname.value,email:serviced_input_email.value,phone:serviced_input_phone.value},n={UTMCampaign:sessionStorage.getItem("utm_campaign")?sessionStorage.getItem("utm_campaign"):"",UTMContent:sessionStorage.getItem("utm_content")?sessionStorage.getItem("utm_content"):document.referrer,UTMMedium:sessionStorage.getItem("utm_medium")?sessionStorage.getItem("utm_medium"):"rent-estimate-popup",UTMSource:sessionStorage.getItem("utm_source")?sessionStorage.getItem("utm_source"):"organic",UTMTerm:sessionStorage.getItem("utm_term")?sessionStorage.getItem("utm_term"):""},a=document.getElementsByClassName("modal_loading-box")[0];return document.querySelector(".modal_component > .modal_heading").style.display="none",form_serviced.style.display="none",a.style.display="flex",console.log(n),registerOwner(o,t,n),form_rent_estimate.reset(),form_serviced.reset(),!1})),form_unserviced.addEventListener("submit",(e=>{e.preventDefault();const t=unserviced_input_fullname.value,o=unserviced_input_email.value,n=autocomplete_input.value,a=property_type.value,m=bedroom_count.value,r=bathroom_count.value,s=new Date,c={Timestamp:s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()+" "+(s.getHours()+":"+s.getMinutes()+":"+s.getSeconds()),utm_source:"WEB-organic",utm_campaign:"",utm_medium:"rent estimate outbound form",utm_content:"","Full Name":t,Email:o,"Property Address":n,"Property Type":a,Bedrooms:m,Bathrooms:r};let i=document.querySelector("#unserviced-block_trigger-layer .modal_component > .modal_button-close"),p=document.getElementsByClassName("modal_loading-box")[1],u=document.querySelector(".modal_component > .modal_heading.for-modal-unserviced"),l=document.querySelector(".modal_component > .text-color-white.for-modal-unserviced");return unserviced_map.style.display="none",u.style.display="none",l.style.display="none",i.style.display="none",form_unserviced.style.display="none",p.style.display="flex",pipeToGoogleSheet("https://script.google.com/macros/s/AKfycbwZSqwAs6FBluPYSz1kTQwVRFCA4KDXV85rvFUcIVplO97w_Mq6ZW2D2cm3afKpnnvG/exec",c),form_rent_estimate.reset(),form_unserviced.reset(),!1}))}));
//# sourceMappingURL=rent-estimate_former.min.js.map
</script>